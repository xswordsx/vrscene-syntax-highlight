{
	"$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
	"name": "vrscene",
    "scopeName": "source.vrscene",
	"patterns": [
		{ "include": "#comments" },
		{ "include": "#strings" },
		{ "include": "#numbers" },
		{ "include": "#block" }
	],
	"repository": {
		"comments": {
			"name": "comment.line.double-slash.vrscene",
			"match": "//.*$"
		},
		"escaped-chars": {
			"name": "constant.character.escape.vrscene",
			"match": "\\\\."
		},
		"strings": {
			"name": "string.quoted.vrscene",
			"begin": "\"",
			"end": "\"",
			"patterns": [{ "include": "#escaped-chars" }]
		},
		"numbers": {
			"name": "constant.numeric.vrscene",
			"match": "[\\+\\-]?\\d*\\.?\\d+(?:[Ee][\\+\\-]?\\d+)?"
		},
		"termination": {
			"name": "punctuation.terminator.statement.vrscene",
			"match": ";"
		},
		"separator": {
			"name": "punctuation.separator.comma.vrscene",
			"match": ","
		},
		"arithmetic": {
			"name": "keyword.operator.arithmetic.vrscene",
			"match": "[+-/*]"
		},
		"brace-round": {
			"name": "meta.brace.round.vrscene",
			"match": "[()]"
		},
		"brace-curly": {
			"name": "meta.brace.curly.vrscene",
			"match": "[{}]"
		},
		"brace-square": {
			"name": "meta.brace.square.vrscene",
			"match": "[[\\]]"
		},
		"variable": {
			"name": "variable.other.vrscene",
			"match": ".*@.*"
		},

		"vector": {
			"match": "(Vector)\\((.*?)\\)",
			"captures": {
				"1": { "name": "support.class.builtin.vector.vrscene" },
				"2": {
					"patterns": [
						{ "include": "#numbers" },
						{ "include": "#arithmetic" },
						{ "include": "#separator" }
					]
				},
				"3": { "name": "support.class.builtin.vector.vrscene" }
			}
		},
		"matrix": {
			"match": "(Matrix)\\((.*)\\)",
			"captures": {
				"1": { "name": "support.class.builtin.matrix.vrscene" },
				"2": {
					"patterns": [
						{"include": "#vector"},
						{ "include": "#numbers" },
						{ "include": "#separator" }
					]
				},
				"3": { "name": "support.class.builtin.matrix.vrscene" }
			}
		},

		"transform": {
			"match": "(Transform)\\s*\\((.*)\\)",
			"captures": {
				"1": { "name": "support.class.builtin.transform.vrscene" },
				"2": {
					"patterns": [
						{
							"match": "(Matrix.*)\\s*,\\s*(Vector.*)",
							"captures": {
								"1": { "patterns": [{ "include": "#matrix" }]},
								"2": { "patterns": [
									{ "include": "#vector" },
									{ "include": "#numbers" },
									{ "include": "#arithmetic" }
								]}
							}
						},
						{ "include": "#matrix" },
						{ "include": "#vector" },
						{ "include": "#numbers" },
						{ "include": "#separator" }
					]
				},
				"3": { "name": "support.class.builtin.transform.vrscene" }
			}
		},

		"builtin": {
			"match": "(AColor|Color|ListIntHex|ListColor|ListColorHex|ListFloat|ListString|ListInt|ListVectorHex|ListVector|Matrix|TransformHex|Transform|Vector|interpolate|List)\\((.*?)(?:\\))",
			"captures": {
				"1": { "name": "support.class.builtin.vrscene" },
				"2": { "name": "TODO" },
				"3": { "name": "support.class.builtin.vrscene" }
			}
		},

		"block": {
			"comment": "This is the main entrypoint for most of the parsing",
			"name": "meta.definition.block",
			"begin": "^\\s*(\\w+)(?:\\s+(\\S+))?\\s*({)",
			"end": "(})$",
			"beginCaptures": {
				"1": { "name": "storage.type.vrscene" },
				"2": { "name": "variable.name.vrscene" },
				"3": { "name": "punctuation.definition.begin.bracket.curly.vrscene" }
			},
			"endCaptures": {
				"1": { "name": "punctuation.definition.end.bracket.curly.vrscene" }
			},
			"patterns": [
				{ "include": "#comments" },
				{
					"begin": "\\s*(.*)\\s*(=)\\s*(.*)",
					"end": ";??",
					"comment": "\\s*(.*)\\s*(=)\\s*(.*)\\s*",
					"beginCaptures": {
						"1": { "name": "support.property.vrscene" },
						"2": { "name": "keyword.operator.assignment.vrscene" },
						"3": {
							"name": "support.property-value.vrscene",
							"patterns": [
								{ "include": "#transform" },
								{ "include": "#builtin" },
								{ "include": "#numbers" },
								{ "include": "#strings" },
								{ "include": "#variable" },
								{ "include": "#comments" }
							]
						}
					}
				}
			]
		}
	}
}